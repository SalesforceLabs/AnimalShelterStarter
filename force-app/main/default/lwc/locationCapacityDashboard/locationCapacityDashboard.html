<template>
    <lightning-card title="Location Capacity Dashboard" icon-name="standard:dashboard_component">
        <lightning-combobox 
            name="siteSelector" 
            label="Select a Site" 
            value={selectedSiteId} 
            placeholder="Choose a Site"
            options={siteOptions}
            onchange={handleSiteChange}></lightning-combobox>
        <template if:true={locations}>
                <div class="slds-grid slds-wrap locations-list">
                    <template for:each={locations} for:item="loc">
                        <div key={loc.Id} class="location-block-box slds-var-p-around_small slds-var-m-bottom_small">
                                <p><strong>{loc.animalshelters__Name__c} - Block Capacity: {loc.animalshelters__Available_Capacity__c}</strong></p>
                                <div class="slds-border_top"></div>
                                <div class="unit-locations">
                                <template if:true={loc.animalshelters__Locations__r}>
                                    <template for:each={loc.animalshelters__Locations__r} for:item="uloc">
                                        <div key={uloc.Id} class="unit-box">
                                            <p>{uloc.animalshelters__Name__c}</p>
                                            <p>{uloc.animalshelters__Location_Capacity__c}</p>
                                            <p>Capacity: {uloc.animalshelters__Capacity__c}</p>
                                            <p>Last Assessment: {uloc.animalshelters__Last_Assessment_Date__c}</p>
                                        </div> 
                                    </template>
                                </template>
                            </div>
                        </div>
                    </template>
                </div>
        </template>
        <template if:true={error}>
            <p>{error}</p>
        </template>
    </lightning-card>
</template>